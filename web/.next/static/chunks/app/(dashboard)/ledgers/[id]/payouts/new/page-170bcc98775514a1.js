(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[143],{9022:function(e,r,t){Promise.resolve().then(t.bind(t,3406))},9205:function(e,r,t){"use strict";t.d(r,{Z:function(){return d}});var a=t(2265);let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===r).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,a.forwardRef)((e,r)=>{let{color:t="currentColor",size:n=24,strokeWidth:l=2,absoluteStrokeWidth:d,className:c="",children:u,iconNode:i,...m}=e;return(0,a.createElement)("svg",{ref:r,...s,width:n,height:n,stroke:t,strokeWidth:d?24*Number(l)/Number(n):l,className:o("lucide",c),...m},[...i.map(e=>{let[r,t]=e;return(0,a.createElement)(r,t)}),...Array.isArray(u)?u:[u]])}),d=(e,r)=>{let t=(0,a.forwardRef)((t,s)=>{let{className:d,...c}=t;return(0,a.createElement)(l,{ref:s,iconNode:r,className:o("lucide-".concat(n(e)),d),...c})});return t.displayName="".concat(e),t}},2660:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(9205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},7648:function(e,r,t){"use strict";t.d(r,{default:function(){return n.a}});var a=t(2972),n=t.n(a)},9376:function(e,r,t){"use strict";var a=t(5475);t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})},3406:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return d}});var a=t(7437),n=t(2265),o=t(9376),s=t(7648),l=t(2660);function d(e){let{params:r}=e,{id:t}=(0,n.use)(r),d=(0,o.useSearchParams)().get("creator")||"",[c,u]=(0,n.useState)(d),[i,m]=(0,n.useState)(""),[f,h]=(0,n.useState)(!0),[x,p]=(0,n.useState)("bank_transfer"),[b,g]=(0,n.useState)(""),[y,v]=(0,n.useState)(""),[j,N]=(0,n.useState)(!1),[k,w]=(0,n.useState)(null),[P,S]=(0,n.useState)(null),[C,_]=(0,n.useState)([]),A=(0,o.useRouter)();(0,n.useEffect)(()=>{(async function(){let e=await fetch("/api/ledgers/".concat(t,"/balances?type=creator_balance")),r=await e.json();r.balances&&_(r.balances.filter(e=>e.balance>0))})()},[t]),(0,n.useEffect)(()=>{let e=C.find(e=>e.entity_id===c);e?(S(e.balance),f&&m((e.balance/100).toFixed(2))):S(null)},[c,C,f]);let E=async e=>{e.preventDefault(),N(!0),w(null);try{let e=await fetch("/api/ledgers/".concat(t,"/payouts"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({creator_id:c,amount:f?void 0:Math.round(100*parseFloat(i)),method:x,reference_id:b||"payout_".concat(Date.now()),notes:y})}),r=await e.json();if(!e.ok)throw Error(r.error||"Failed to process payout");A.push("/ledgers/".concat(t,"/payouts"))}catch(e){w(e.message),N(!1)}};return(0,a.jsxs)("div",{className:"max-w-2xl",children:[(0,a.jsxs)(s.default,{href:"/ledgers/".concat(t,"/payouts"),className:"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground mb-6",children:[(0,a.jsx)(l.Z,{className:"h-4 w-4"}),"Back to payouts"]}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Process Payout"}),(0,a.jsx)("p",{className:"mt-2 text-muted-foreground",children:"Pay out creator earnings from their balance."}),(0,a.jsxs)("div",{className:"mt-8 bg-card border border-border rounded-lg p-6",children:[k&&(0,a.jsx)("div",{className:"mb-6 p-3 bg-destructive/10 border border-destructive/20 rounded-md text-destructive text-sm",children:k}),(0,a.jsxs)("form",{onSubmit:E,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Creator"}),C.length>0?(0,a.jsxs)("select",{value:c,onChange:e=>u(e.target.value),required:!0,className:"w-full px-4 py-3 border border-border rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary",children:[(0,a.jsx)("option",{value:"",children:"Select a creator"}),C.map(e=>(0,a.jsxs)("option",{value:e.entity_id,children:[e.entity_id," - $",(e.balance/100).toFixed(2)," available"]},e.entity_id))]}):(0,a.jsx)("div",{className:"px-4 py-3 bg-muted rounded-md text-muted-foreground text-sm",children:"No creators with pending balance"})]}),null!==P&&(0,a.jsx)("div",{className:"p-4 bg-muted/50 rounded-lg",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Available balance"}),(0,a.jsxs)("span",{className:"font-bold text-foreground",children:["$",(P/100).toFixed(2)]})]})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"payAll",checked:f,onChange:e=>h(e.target.checked),className:"w-4 h-4 rounded border-border"}),(0,a.jsx)("label",{htmlFor:"payAll",className:"text-sm text-foreground",children:"Pay full balance"})]}),!f&&(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),(0,a.jsx)("input",{type:"number",step:"0.01",min:"0",max:P?P/100:void 0,value:i,onChange:e=>m(e.target.value),required:!f,className:"w-full pl-8 pr-4 py-3 border border-border rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"0.00"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Payment method"}),(0,a.jsxs)("select",{value:x,onChange:e=>p(e.target.value),className:"w-full px-4 py-3 border border-border rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary",children:[(0,a.jsx)("option",{value:"bank_transfer",children:"Bank Transfer (ACH)"}),(0,a.jsx)("option",{value:"check",children:"Check"}),(0,a.jsx)("option",{value:"paypal",children:"PayPal"}),(0,a.jsx)("option",{value:"stripe",children:"Stripe Connect"}),(0,a.jsx)("option",{value:"other",children:"Other"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Reference ID (optional)"}),(0,a.jsx)("input",{type:"text",value:b,onChange:e=>g(e.target.value),className:"w-full px-4 py-3 border border-border rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"e.g., check number, PayPal transaction ID"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Notes (optional)"}),(0,a.jsx)("textarea",{value:y,onChange:e=>v(e.target.value),rows:2,className:"w-full px-4 py-3 border border-border rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary resize-none",placeholder:"Internal notes"})]}),(0,a.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,a.jsx)("button",{type:"submit",disabled:j||!c||0===C.length,className:"flex-1 bg-primary text-primary-foreground py-3 rounded-md font-medium hover:bg-primary/90 disabled:opacity-50",children:j?"Processing...":"Process payout"}),(0,a.jsx)(s.default,{href:"/ledgers/".concat(t,"/payouts"),className:"px-6 py-3 border border-border rounded-md text-foreground hover:bg-accent text-center",children:"Cancel"})]})]})]})]})}}},function(e){e.O(0,[2972,2971,2117,1744],function(){return e(e.s=9022)}),_N_E=e.O()}]);