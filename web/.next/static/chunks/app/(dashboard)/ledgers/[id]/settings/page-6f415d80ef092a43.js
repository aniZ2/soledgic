(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9726],{7910:function(e,r,t){Promise.resolve().then(t.bind(t,7955))},9205:function(e,r,t){"use strict";t.d(r,{Z:function(){return l}});var s=t(2265);let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===r).join(" ").trim()};var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,s.forwardRef)((e,r)=>{let{color:t="currentColor",size:n=24,strokeWidth:d=2,absoluteStrokeWidth:l,className:i="",children:c,iconNode:u,...m}=e;return(0,s.createElement)("svg",{ref:r,...a,width:n,height:n,stroke:t,strokeWidth:l?24*Number(d)/Number(n):d,className:o("lucide",i),...m},[...u.map(e=>{let[r,t]=e;return(0,s.createElement)(r,t)}),...Array.isArray(c)?c:[c]])}),l=(e,r)=>{let t=(0,s.forwardRef)((t,a)=>{let{className:l,...i}=t;return(0,s.createElement)(d,{ref:a,iconNode:r,className:o("lucide-".concat(n(e)),l),...i})});return t.displayName="".concat(e),t}},2660:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});let s=(0,t(9205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},401:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});let s=(0,t(9205).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},8867:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});let s=(0,t(9205).Z)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},7168:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});let s=(0,t(9205).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},7648:function(e,r,t){"use strict";t.d(r,{default:function(){return n.a}});var s=t(2972),n=t.n(s)},9376:function(e,r,t){"use strict";var s=t(5475);t.o(s,"usePathname")&&t.d(r,{usePathname:function(){return s.usePathname}}),t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(r,{useSearchParams:function(){return s.useSearchParams}})},7955:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return u}});var s=t(7437),n=t(2265),o=t(9376),a=t(7648),d=t(2660),l=t(401),i=t(8867),c=t(7168);function u(e){let{params:r}=e,{id:t}=(0,n.use)(r),u=(0,o.useRouter)(),[m,x]=(0,n.useState)(null),[h,f]=(0,n.useState)(!0),[g,b]=(0,n.useState)(!1),[p,v]=(0,n.useState)(!1),[y,j]=(0,n.useState)(null),[N,k]=(0,n.useState)(""),[w,S]=(0,n.useState)(""),[_,C]=(0,n.useState)("active"),[A,P]=(0,n.useState)("20"),[Z,E]=(0,n.useState)("10"),[L,T]=(0,n.useState)("manual");(0,n.useEffect)(()=>{!async function(){let e=await fetch("/api/ledgers/".concat(t)),r=await e.json();if(r.ledger){var s,n,o;x(r.ledger),k(r.ledger.platform_name),S(r.ledger.owner_email),C(r.ledger.status),P(String((null===(s=r.ledger.settings)||void 0===s?void 0:s.default_platform_fee_percent)||20)),E(String((null===(n=r.ledger.settings)||void 0===n?void 0:n.min_payout_amount)||10)),T((null===(o=r.ledger.settings)||void 0===o?void 0:o.payout_schedule)||"manual")}f(!1)}()},[t]);let M=async()=>{b(!0),j(null);try{if(!(await fetch("/api/ledgers/".concat(t),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform_name:N,owner_email:w,status:_,settings:{default_platform_fee_percent:parseInt(A),min_payout_amount:parseInt(Z),payout_schedule:L}})})).ok)throw Error("Failed to save");j({type:"success",text:"Settings saved"})}catch(e){j({type:"error",text:"Failed to save settings"})}b(!1)},I=async()=>{if(confirm("Archive this ledger? It will be hidden but data preserved."))try{await fetch("/api/ledgers/".concat(t),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"archived"})}),u.push("/ledgers")}catch(e){j({type:"error",text:"Failed to archive"})}},R=async()=>{if(confirm("DELETE this ledger? This cannot be undone.")&&confirm("Are you absolutely sure? All data will be permanently lost."))try{await fetch("/api/ledgers/".concat(t),{method:"DELETE"}),u.push("/ledgers")}catch(e){j({type:"error",text:"Failed to delete"})}};return h?(0,s.jsx)("div",{className:"text-muted-foreground",children:"Loading..."}):m?(0,s.jsxs)("div",{className:"max-w-3xl",children:[(0,s.jsxs)(a.default,{href:"/ledgers/".concat(t),className:"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground mb-6",children:[(0,s.jsx)(d.Z,{className:"h-4 w-4"}),"Back to ledger"]}),(0,s.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Ledger Settings"}),(0,s.jsxs)("p",{className:"mt-1 text-muted-foreground",children:["Configure ",m.platform_name]}),y&&(0,s.jsx)("div",{className:"mt-4 p-3 rounded-md text-sm ".concat("success"===y.type?"bg-green-500/10 text-green-500 border border-green-500/20":"bg-destructive/10 text-destructive border border-destructive/20"),children:y.text}),(0,s.jsxs)("div",{className:"mt-8 bg-card border border-border rounded-lg",children:[(0,s.jsx)("div",{className:"p-6 border-b border-border",children:(0,s.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:"General"})}),(0,s.jsxs)("div",{className:"p-6 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Business name"}),(0,s.jsx)("input",{type:"text",value:N,onChange:e=>k(e.target.value),className:"w-full px-4 py-3 border border-border rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Owner email"}),(0,s.jsx)("input",{type:"email",value:w,onChange:e=>S(e.target.value),className:"w-full px-4 py-3 border border-border rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Status"}),(0,s.jsxs)("select",{value:_,onChange:e=>C(e.target.value),className:"w-full px-4 py-3 border border-border rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary",children:[(0,s.jsx)("option",{value:"active",children:"Active"}),(0,s.jsx)("option",{value:"inactive",children:"Inactive"})]})]}),(0,s.jsx)("button",{onClick:M,disabled:g,className:"bg-primary text-primary-foreground px-4 py-2 rounded-md hover:bg-primary/90 disabled:opacity-50",children:g?"Saving...":"Save changes"})]})]}),(0,s.jsxs)("div",{className:"mt-6 bg-card border border-border rounded-lg",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-border",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:"Platform Settings"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"For marketplace/creator platforms"})]}),(0,s.jsxs)("div",{className:"p-6 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Default platform fee (%)"}),(0,s.jsx)("input",{type:"number",min:"0",max:"100",value:A,onChange:e=>P(e.target.value),className:"w-full px-4 py-3 border border-border rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary"}),(0,s.jsx)("p",{className:"mt-1 text-xs text-muted-foreground",children:"Percentage kept from each sale. Set to 100 for non-marketplace businesses."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Minimum payout amount ($)"}),(0,s.jsx)("input",{type:"number",min:"0",step:"1",value:Z,onChange:e=>E(e.target.value),className:"w-full px-4 py-3 border border-border rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Payout schedule"}),(0,s.jsxs)("select",{value:L,onChange:e=>T(e.target.value),className:"w-full px-4 py-3 border border-border rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary",children:[(0,s.jsx)("option",{value:"manual",children:"Manual"}),(0,s.jsx)("option",{value:"weekly",children:"Weekly"}),(0,s.jsx)("option",{value:"biweekly",children:"Bi-weekly"}),(0,s.jsx)("option",{value:"monthly",children:"Monthly"})]})]}),(0,s.jsx)("button",{onClick:M,disabled:g,className:"bg-primary text-primary-foreground px-4 py-2 rounded-md hover:bg-primary/90 disabled:opacity-50",children:g?"Saving...":"Save changes"})]})]}),(0,s.jsxs)("div",{className:"mt-6 bg-card border border-border rounded-lg",children:[(0,s.jsx)("div",{className:"p-6 border-b border-border",children:(0,s.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:"API Access"})}),(0,s.jsxs)("div",{className:"p-6 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"API Key"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("code",{className:"flex-1 px-4 py-3 bg-muted rounded-md text-sm font-mono text-foreground overflow-x-auto",children:m.api_key}),(0,s.jsx)("button",{onClick:()=>{navigator.clipboard.writeText((null==m?void 0:m.api_key)||""),v(!0),setTimeout(()=>v(!1),2e3)},className:"p-3 border border-border rounded-md hover:bg-accent",children:p?(0,s.jsx)(l.Z,{className:"h-4 w-4 text-green-500"}):(0,s.jsx)(i.Z,{className:"h-4 w-4"})})]}),(0,s.jsx)("p",{className:"mt-2 text-xs text-muted-foreground",children:"This key has full access to this ledger. Keep it secure."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Ledger ID"}),(0,s.jsx)("code",{className:"block px-4 py-3 bg-muted rounded-md text-sm font-mono text-muted-foreground",children:m.id})]}),(0,s.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 border border-border rounded-md hover:bg-accent",children:[(0,s.jsx)(c.Z,{className:"h-4 w-4"}),"Regenerate API key"]})]})]}),(0,s.jsxs)("div",{className:"mt-6 bg-card border border-destructive/50 rounded-lg",children:[(0,s.jsx)("div",{className:"p-6 border-b border-destructive/50",children:(0,s.jsx)("h2",{className:"text-lg font-semibold text-destructive",children:"Danger Zone"})}),(0,s.jsxs)("div",{className:"p-6 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-foreground",children:"Archive this ledger"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Archiving will hide this ledger from your dashboard but preserve all data."})]}),(0,s.jsx)("button",{onClick:I,className:"px-4 py-2 border border-border rounded-md hover:bg-accent text-sm",children:"Archive"})]}),(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4 pt-4 border-t border-border",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-foreground",children:"Delete this ledger"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Permanently delete this ledger and all its transactions. This cannot be undone."})]}),(0,s.jsx)("button",{onClick:R,className:"px-4 py-2 border border-destructive text-destructive rounded-md hover:bg-destructive/10 text-sm",children:"Delete"})]})]})]})]}):(0,s.jsx)("div",{className:"text-muted-foreground",children:"Ledger not found"})}}},function(e){e.O(0,[2972,2971,2117,1744],function(){return e(e.s=7910)}),_N_E=e.O()}]);