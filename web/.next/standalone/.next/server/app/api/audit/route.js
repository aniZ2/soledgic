"use strict";(()=>{var e={};e.id=8701,e.ids=[8701],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},16373:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>I,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var a={};r.r(a),r.d(a,{POST:()=>d});var o=r(49303),s=r(88716),i=r(60670),n=r(87070);let u=(0,r(37857).eI)("https://ocjrcsmoeikxfooeglkt.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9janJjc21vZWlreGZvb2VnbGt0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzQ0ODI5NTAsImV4cCI6MjA1MDA1ODk1MH0.xAn_fLr5TuOVZt2RqRCDGJBj7FjOJYoWM1dDLa-RrEk"),c="0a885204-e07a-48c1-97e9-495ac96a2581";async function d(e){try{let{action:t,limit:r=50,offset:a=0,filters:o}=await e.json();if("list"===t){let e=u.from("audit_log").select("*").eq("ledger_id",c).order("created_at",{ascending:!1}).range(a,a+r-1);o?.entity_type&&(e=e.eq("entity_type",o.entity_type)),o?.action_type&&(e=e.eq("action",o.action_type));let{data:t,error:s}=await e;if(s)return console.error("Audit query error:",s),n.NextResponse.json({success:!1,error:s.message},{status:500});return n.NextResponse.json({success:!0,data:t||[],count:t?.length||0})}if("summary"===t){let e=new Date().toISOString().split("T")[0],[t,r,a]=await Promise.all([u.from("audit_log").select("id",{count:"exact",head:!0}).eq("ledger_id",c),u.from("audit_log").select("id",{count:"exact",head:!0}).eq("ledger_id",c).gte("created_at",e),u.from("accounts").select("id",{count:"exact",head:!0}).eq("ledger_id",c)]);return n.NextResponse.json({success:!0,data:{total_entries:t.count||0,today_entries:r.count||0,total_accounts:a.count||0}})}return n.NextResponse.json({error:"Unknown action"},{status:400})}catch(e){return console.error("Audit API error:",e),n.NextResponse.json({error:"Failed to fetch audit log"},{status:500})}}let p=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/audit/route",pathname:"/api/audit",filename:"route",bundlePath:"app/api/audit/route"},resolvedPagePath:"/Users/osifo/Desktop/soledgic/web/src/app/api/audit/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:g}=p,x="/api/audit/route";function I(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,3786,5972],()=>r(16373));module.exports=a})();